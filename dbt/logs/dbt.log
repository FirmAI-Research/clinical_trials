[0m19:58:53.070061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764497bd8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7644962bc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7644962bc3a0>]}


============================== 19:58:53.071917 | a8642a15-307a-438c-aaac-76325d4baf58 ==============================
[0m19:58:53.071917 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:58:53.072358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:58:53.226951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76449614d210>]}
[0m19:58:53.276972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764496290460>]}
[0m19:58:53.279088 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m19:58:53.285242 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:58:53.285830 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:58:53.286181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7644961dd900>]}
[0m19:58:54.128159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m19:58:54.136387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7644903d7f40>]}
[0m19:58:54.194369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7644903b24a0>]}
[0m19:58:54.194853 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m19:58:54.195212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7644903b0f70>]}
[0m19:58:54.196411 [info ] [MainThread]: 
[0m19:58:54.196910 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:58:54.200532 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m19:58:54.220894 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m19:58:54.221269 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m19:58:54.221579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:54.244658 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:58:54.245674 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m19:58:54.248343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m19:58:54.248838 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m19:58:54.253769 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:58:54.254160 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m19:58:54.254443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:54.273894 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m19:58:54.274924 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:58:54.275266 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m19:58:54.275659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:58:54.275981 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:58:54.276263 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m19:58:54.276679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:58:54.277330 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m19:58:54.277640 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:58:54.277935 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m19:58:54.278327 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:58:54.278641 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m19:58:54.281521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m19:58:54.285598 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m19:58:54.285994 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m19:58:54.286329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:54.304884 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m19:58:54.305243 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m19:58:54.305535 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m19:58:54.323372 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m19:58:54.324331 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m19:58:54.324780 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m19:58:54.325084 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m19:58:54.328000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764496272530>]}
[0m19:58:54.328413 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:54.328719 [debug] [MainThread]: On master: BEGIN
[0m19:58:54.329024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:58:54.349786 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m19:58:54.350158 [debug] [MainThread]: On master: COMMIT
[0m19:58:54.350462 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:54.350740 [debug] [MainThread]: On master: COMMIT
[0m19:58:54.351178 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:58:54.351481 [debug] [MainThread]: On master: Close
[0m19:58:54.353829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:58:54.354190 [info ] [MainThread]: 
[0m19:58:54.355624 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m19:58:54.356249 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m19:58:54.356882 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m19:58:54.357368 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m19:58:54.363117 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.363647 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m19:58:54.385922 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.386644 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.386995 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m19:58:54.387316 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:58:54.410164 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m19:58:54.410595 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.410950 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m19:58:54.411931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:58:54.417010 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.417383 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m19:58:54.417881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:58:54.420063 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.420414 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m19:58:54.420956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:58:54.432479 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m19:58:54.432851 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.433180 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m19:58:54.449930 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m19:58:54.453397 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:58:54.453751 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m19:58:54.462450 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:58:54.464071 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m19:58:54.607755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764497c6e140>]}
[0m19:58:54.608609 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.25s]
[0m19:58:54.609214 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m19:58:54.609966 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m19:58:54.610397 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m19:58:54.610836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m19:58:54.611195 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m19:58:54.614791 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m19:58:54.615312 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m19:58:54.629346 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m19:58:54.629856 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m19:58:54.630205 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m19:58:54.630514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:54.650267 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m19:58:54.650685 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m19:58:54.651094 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.phase,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc ON s.nct_id = sc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations" loc ON s.nct_id = loc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i ON s.nct_id = i._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae ON s.nct_id = ae._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm ON s.nct_id = bm._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om ON s.nct_id = om._dlt_root_id
)
SELECT * FROM base_studies
    );
  
  
[0m19:58:54.652721 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.phase,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc ON s.nct_id = sc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations" loc ON s.nct_id = loc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i ON s.nct_id = i._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae ON s.nct_id = ae._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm ON s.nct_id = bm._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om ON s.nct_id = om._dlt_root_id
)
SELECT * FROM base_studies
    );
  
  
[0m19:58:54.653162 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:58:54.653633 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: ROLLBACK
[0m19:58:54.654878 [debug] [Thread-1 (]: Failed to rollback 'model.clinical_trials.clinicaltrials_mart'
[0m19:58:54.655223 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m19:58:54.657871 [debug] [Thread-1 (]: Runtime Error in model clinicaltrials_mart (models/marts/clinicaltrials_mart.sql)
  Binder Error: Values list "s" does not have a column named "phase"
  LINE 20:         s.phase,
                   ^
[0m19:58:54.658418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8642a15-307a-438c-aaac-76325d4baf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76448c744670>]}
[0m19:58:54.658994 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model main.clinicaltrials_mart ................. [[31mERROR[0m in 0.05s]
[0m19:58:54.659517 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m19:58:54.660844 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:54.661216 [debug] [MainThread]: On master: BEGIN
[0m19:58:54.661522 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:58:54.682379 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m19:58:54.682803 [debug] [MainThread]: On master: COMMIT
[0m19:58:54.683113 [debug] [MainThread]: Using duckdb connection "master"
[0m19:58:54.683389 [debug] [MainThread]: On master: COMMIT
[0m19:58:54.683827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:58:54.684179 [debug] [MainThread]: On master: Close
[0m19:58:54.686566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:54.686918 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m19:58:54.687197 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m19:58:54.687509 [info ] [MainThread]: 
[0m19:58:54.687886 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m19:58:54.688523 [debug] [MainThread]: Command end result
[0m19:58:54.705671 [info ] [MainThread]: 
[0m19:58:54.706078 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:58:54.706393 [info ] [MainThread]: 
[0m19:58:54.706738 [error] [MainThread]:   Runtime Error in model clinicaltrials_mart (models/marts/clinicaltrials_mart.sql)
  Binder Error: Values list "s" does not have a column named "phase"
  LINE 20:         s.phase,
                   ^
[0m19:58:54.707038 [info ] [MainThread]: 
[0m19:58:54.707340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:58:54.707950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6808722, "process_user_time": 2.363093, "process_kernel_time": 0.115936, "process_mem_max_rss": "190388", "process_out_blocks": "12464", "command_success": false, "process_in_blocks": "0"}
[0m19:58:54.708422 [debug] [MainThread]: Command `dbt run` failed at 19:58:54.708356 after 1.68 seconds
[0m19:58:54.708786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764497bd8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764496290460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76448c7857e0>]}
[0m19:58:54.709139 [debug] [MainThread]: Flushing usage events
[0m19:59:35.568080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5d228340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5b864370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5b8643d0>]}


============================== 19:59:35.569950 | 0625d742-ce6b-49b0-abd7-c78a6ab9106c ==============================
[0m19:59:35.569950 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:59:35.570394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'debug': 'False', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:59:35.722381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5d2b9a50>]}
[0m19:59:35.772015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5b82cca0>]}
[0m19:59:35.774127 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m19:59:35.780213 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:59:35.850475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:59:35.851027 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m19:59:36.038805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m19:59:36.048089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5516f400>]}
[0m19:59:36.106037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af55b6e290>]}
[0m19:59:36.106525 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m19:59:36.106860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af55b6f790>]}
[0m19:59:36.108019 [info ] [MainThread]: 
[0m19:59:36.108495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:59:36.111964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m19:59:36.164676 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m19:59:36.165111 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m19:59:36.165422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:36.189505 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:59:36.190560 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m19:59:36.193232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m19:59:36.193701 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m19:59:36.198665 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:59:36.199026 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m19:59:36.199315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:36.219199 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:59:36.220220 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:59:36.220554 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m19:59:36.220968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:59:36.221276 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:59:36.221568 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m19:59:36.222006 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:59:36.222638 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m19:59:36.222950 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m19:59:36.223236 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m19:59:36.223621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:59:36.223936 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m19:59:36.226812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m19:59:36.230799 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m19:59:36.231143 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m19:59:36.231430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:36.250086 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m19:59:36.250436 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m19:59:36.250735 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m19:59:36.268447 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m19:59:36.269387 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m19:59:36.269843 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m19:59:36.270145 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m19:59:36.273161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5d009930>]}
[0m19:59:36.273592 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:36.273902 [debug] [MainThread]: On master: BEGIN
[0m19:59:36.274181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:36.294953 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m19:59:36.295348 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.295644 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:36.295931 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.296318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:59:36.296637 [debug] [MainThread]: On master: Close
[0m19:59:36.299007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:36.299359 [info ] [MainThread]: 
[0m19:59:36.301045 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m19:59:36.301536 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m19:59:36.302042 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m19:59:36.302386 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m19:59:36.308102 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.308585 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m19:59:36.330415 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.330933 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.331295 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m19:59:36.331629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:59:36.354677 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m19:59:36.355117 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.355481 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m19:59:36.356504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:59:36.361195 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.361577 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m19:59:36.362091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:59:36.364264 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.364614 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m19:59:36.365101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:59:36.376622 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m19:59:36.377011 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.377358 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m19:59:36.386074 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:59:36.389359 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m19:59:36.389707 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m19:59:36.398364 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:59:36.399953 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m19:59:36.555287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5d009930>]}
[0m19:59:36.556524 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.25s]
[0m19:59:36.557604 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m19:59:36.559025 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m19:59:36.559863 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m19:59:36.560637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m19:59:36.561139 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m19:59:36.565315 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m19:59:36.565786 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m19:59:36.579340 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m19:59:36.579842 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m19:59:36.580193 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m19:59:36.580512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:36.599973 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m19:59:36.600387 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m19:59:36.600800 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc ON s.nct_id = sc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations" loc ON s.nct_id = loc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i ON s.nct_id = i._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae ON s.nct_id = ae._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm ON s.nct_id = bm._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om ON s.nct_id = om._dlt_root_id
)
SELECT * FROM base_studies
    );
  
  
[0m19:59:36.617392 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m19:59:36.619945 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m19:59:36.620313 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m19:59:36.620960 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:59:36.624620 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m19:59:36.624978 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m19:59:36.625297 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m19:59:36.637981 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m19:59:36.639831 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m19:59:36.640162 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m19:59:36.640620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:59:36.641564 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m19:59:36.806920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0625d742-ce6b-49b0-abd7-c78a6ab9106c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5bd54610>]}
[0m19:59:36.807626 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 0.25s]
[0m19:59:36.808203 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m19:59:36.809217 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:36.809607 [debug] [MainThread]: On master: BEGIN
[0m19:59:36.809923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:36.830754 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m19:59:36.831149 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.831451 [debug] [MainThread]: Using duckdb connection "master"
[0m19:59:36.831728 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.832180 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:59:36.832495 [debug] [MainThread]: On master: Close
[0m19:59:36.834811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:36.835199 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m19:59:36.835505 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m19:59:36.835851 [info ] [MainThread]: 
[0m19:59:36.836175 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m19:59:36.836788 [debug] [MainThread]: Command end result
[0m19:59:36.854797 [info ] [MainThread]: 
[0m19:59:36.855215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:36.855537 [info ] [MainThread]: 
[0m19:59:36.855856 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:59:36.856466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3306452, "process_user_time": 1.979928, "process_kernel_time": 0.130522, "process_mem_max_rss": "183772", "process_out_blocks": "28344", "process_in_blocks": "0"}
[0m19:59:36.856951 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:36.856885 after 1.33 seconds
[0m19:59:36.857295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5d228340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af5d47fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78af55b6f340>]}
[0m19:59:36.857634 [debug] [MainThread]: Flushing usage events
[0m20:05:30.094998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e4148280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e27883d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e2788430>]}


============================== 20:05:30.097002 | 3f3f6b13-f0af-49be-9427-04ec6a4a2d0b ==============================
[0m20:05:30.097002 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:05:30.097466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'profiles_dir': 'dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:05:30.256509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e27fb520>]}
[0m20:05:30.307813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e27599f0>]}
[0m20:05:30.310053 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m20:05:30.316291 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:05:30.389758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:05:30.390319 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m20:05:30.585092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m20:05:30.594725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dbf840a0>]}
[0m20:05:30.655701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dd38d3c0>]}
[0m20:05:30.656228 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m20:05:30.656604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dd38fa00>]}
[0m20:05:30.657944 [info ] [MainThread]: 
[0m20:05:30.658451 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:05:30.662176 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m20:05:30.714197 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m20:05:30.714624 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m20:05:30.714934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:30.739266 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:05:30.740334 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m20:05:30.743246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m20:05:30.743730 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m20:05:30.748632 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:05:30.748972 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m20:05:30.749261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:30.769711 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:05:30.770751 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:05:30.771098 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m20:05:30.771515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:05:30.771827 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:05:30.772116 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m20:05:30.772554 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:05:30.773216 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:05:30.773528 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:05:30.773826 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:05:30.774201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:05:30.774529 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m20:05:30.777424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m20:05:30.781523 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:05:30.781850 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m20:05:30.782155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:30.801066 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:05:30.801428 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:05:30.801731 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m20:05:30.819269 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:05:30.820245 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m20:05:30.820710 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m20:05:30.821022 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m20:05:30.824038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e405ef50>]}
[0m20:05:30.824446 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:30.824743 [debug] [MainThread]: On master: BEGIN
[0m20:05:30.825050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:30.846257 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:05:30.846637 [debug] [MainThread]: On master: COMMIT
[0m20:05:30.847025 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:30.847312 [debug] [MainThread]: On master: COMMIT
[0m20:05:30.847698 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:05:30.848008 [debug] [MainThread]: On master: Close
[0m20:05:30.850416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:30.850797 [info ] [MainThread]: 
[0m20:05:30.852546 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:05:30.853066 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m20:05:30.853557 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m20:05:30.853929 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m20:05:30.859606 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.860100 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m20:05:30.882032 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.882572 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.882943 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m20:05:30.883267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:05:30.907653 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m20:05:30.908131 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.908503 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m20:05:30.909680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:05:30.914846 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.915223 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m20:05:30.915740 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:05:30.918006 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.918362 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m20:05:30.918876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:05:30.930888 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:05:30.931272 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.931613 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:05:30.941021 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:05:30.944716 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:05:30.945066 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m20:05:30.953983 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:05:30.955610 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m20:05:31.113586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e405ef50>]}
[0m20:05:31.114294 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.26s]
[0m20:05:31.114855 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:05:31.115620 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m20:05:31.116071 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m20:05:31.116508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m20:05:31.116930 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m20:05:31.120564 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.121031 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m20:05:31.135524 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.136068 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.136442 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m20:05:31.136766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:31.157077 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:05:31.157498 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.157924 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc ON s.nct_id = sc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations" loc ON s.nct_id = loc._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i ON s.nct_id = i._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae ON s.nct_id = ae._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm ON s.nct_id = bm._dlt_root_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om ON s.nct_id = om._dlt_root_id
    WHERE e._dlt_root_id IS NOT NULL
      OR sc._dlt_root_id IS NOT NULL
      OR loc._dlt_root_id IS NOT NULL
      OR i._dlt_root_id IS NOT NULL
      OR ae._dlt_root_id IS NOT NULL
      OR bm._dlt_root_id IS NOT NULL
      OR om._dlt_root_id IS NOT NULL
)
SELECT * FROM base_studies
    );
  
  
[0m20:05:31.169273 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:05:31.171983 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.172361 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart" rename to "clinicaltrials_mart__dbt_backup"
[0m20:05:31.172995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:05:31.175250 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.175610 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m20:05:31.176213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:05:31.180339 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:05:31.180704 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.181038 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:05:31.189943 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:05:31.191704 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:05:31.192040 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m20:05:31.201186 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:05:31.202133 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m20:05:31.353660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f3f6b13-f0af-49be-9427-04ec6a4a2d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e405ef50>]}
[0m20:05:31.354428 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 0.24s]
[0m20:05:31.354982 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m20:05:31.356002 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:31.356407 [debug] [MainThread]: On master: BEGIN
[0m20:05:31.356755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:31.377825 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:05:31.378216 [debug] [MainThread]: On master: COMMIT
[0m20:05:31.378518 [debug] [MainThread]: Using duckdb connection "master"
[0m20:05:31.378800 [debug] [MainThread]: On master: COMMIT
[0m20:05:31.379228 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:05:31.379552 [debug] [MainThread]: On master: Close
[0m20:05:31.381979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:31.382344 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m20:05:31.382648 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m20:05:31.382993 [info ] [MainThread]: 
[0m20:05:31.383316 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m20:05:31.383946 [debug] [MainThread]: Command end result
[0m20:05:31.402921 [info ] [MainThread]: 
[0m20:05:31.403356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:31.403689 [info ] [MainThread]: 
[0m20:05:31.404020 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:05:31.404695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3536452, "process_user_time": 2.035246, "process_kernel_time": 0.11841, "process_mem_max_rss": "187272", "process_out_blocks": "22744", "process_in_blocks": "0"}
[0m20:05:31.405183 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:31.405114 after 1.35 seconds
[0m20:05:31.405536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e4148280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e3408130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e27fb520>]}
[0m20:05:31.405926 [debug] [MainThread]: Flushing usage events
[0m20:06:46.076205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e0333c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e0197fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e0197fe20>]}


============================== 20:06:46.078063 | 60c0d5ff-1c94-474a-aa8b-7019b847c0c6 ==============================
[0m20:06:46.078063 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:06:46.078510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:06:46.228369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e019fc790>]}
[0m20:06:46.277368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e0193d0f0>]}
[0m20:06:46.279445 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m20:06:46.285514 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:06:46.354754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:06:46.355288 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m20:06:46.539969 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m20:06:46.549093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dfb17bfa0>]}
[0m20:06:46.606371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dfc582260>]}
[0m20:06:46.606847 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m20:06:46.607182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dfc581f90>]}
[0m20:06:46.608357 [info ] [MainThread]: 
[0m20:06:46.608849 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:06:46.612422 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m20:06:46.664487 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m20:06:46.664909 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m20:06:46.665218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:46.689589 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:06:46.690661 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m20:06:46.693432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m20:06:46.693923 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m20:06:46.698878 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:06:46.699222 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m20:06:46.699525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:46.721766 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:06:46.722801 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:06:46.723146 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m20:06:46.723558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:06:46.723876 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:06:46.724168 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m20:06:46.724593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:06:46.725241 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:06:46.725544 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:06:46.725836 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:06:46.726220 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:06:46.726541 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m20:06:46.729384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m20:06:46.733508 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:06:46.733870 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m20:06:46.734156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:46.753750 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:06:46.754109 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:06:46.754409 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m20:06:46.772318 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:06:46.773293 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m20:06:46.773760 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m20:06:46.774070 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m20:06:46.776982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e03240820>]}
[0m20:06:46.777394 [debug] [MainThread]: Using duckdb connection "master"
[0m20:06:46.777691 [debug] [MainThread]: On master: BEGIN
[0m20:06:46.777986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:46.798665 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:06:46.799038 [debug] [MainThread]: On master: COMMIT
[0m20:06:46.799324 [debug] [MainThread]: Using duckdb connection "master"
[0m20:06:46.799596 [debug] [MainThread]: On master: COMMIT
[0m20:06:46.799991 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:06:46.800305 [debug] [MainThread]: On master: Close
[0m20:06:46.803840 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:06:46.804205 [info ] [MainThread]: 
[0m20:06:46.805945 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:06:46.806425 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m20:06:46.806929 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m20:06:46.807262 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m20:06:46.812936 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.813399 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m20:06:46.835731 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.836264 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.836652 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m20:06:46.836994 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:06:46.860386 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m20:06:46.860802 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.861159 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m20:06:46.862141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:06:46.866851 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.867230 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m20:06:46.867747 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:06:46.869931 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.870294 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m20:06:46.870788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:06:46.882536 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:06:46.882923 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.883275 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:06:46.892572 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:06:46.896451 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:06:46.896811 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m20:06:46.906101 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:06:46.908068 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m20:06:47.063914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e03240820>]}
[0m20:06:47.064563 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.26s]
[0m20:06:47.065182 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:06:47.065898 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m20:06:47.066326 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m20:06:47.066735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m20:06:47.067081 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m20:06:47.070849 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m20:06:47.071555 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m20:06:47.086172 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m20:06:47.086679 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:06:47.087031 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m20:06:47.087342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:47.107559 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:06:47.107993 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:06:47.108409 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc ON s.nct_id = sc.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations" loc ON s.nct_id = loc.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i ON s.nct_id = i.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae ON s.nct_id = ae.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm ON s.nct_id = bm.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om ON s.nct_id = om.nct_id
)
SELECT * FROM base_studies
    );
  
  
[0m20:06:47.109917 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc ON s.nct_id = sc.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations" loc ON s.nct_id = loc.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i ON s.nct_id = i.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae ON s.nct_id = ae.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm ON s.nct_id = bm.nct_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om ON s.nct_id = om.nct_id
)
SELECT * FROM base_studies
    );
  
  
[0m20:06:47.110370 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:06:47.110858 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: ROLLBACK
[0m20:06:47.112225 [debug] [Thread-1 (]: Failed to rollback 'model.clinical_trials.clinicaltrials_mart'
[0m20:06:47.112584 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m20:06:47.115417 [debug] [Thread-1 (]: Runtime Error in model clinicaltrials_mart (models/marts/clinicaltrials_mart.sql)
  Binder Error: Table "e" does not have a column named "nct_id"
  LINE 29: ...d": "model.clinical_trials.clinicaltrials_mart"} */
  
    
      
      
  
      create  table
        "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
    
      as (
        WITH base_studies AS (
      SELECT 
          s.nct_id,
          s.protocol_section__identification_module__brief_title as brief_title,
          s.protocol_section__identification_module__official_title as official_title,
          s.protocol_section__status_module__overall_status as overall_status,
          s.protocol_section__status_module__start_date_struct__date as start_date,
          s.protocol_section__status_module__completion_date_struct__date as completion_date,
          s.protocol_section__design_module__study_type as study_type,
          s.protocol_section__design_module__enrollment_info__type as enrollment,
          e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
          sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
          loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
          i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
          ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
          bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
          om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
      FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
      LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e.nct_id
                                                     ^
[0m20:06:47.115936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60c0d5ff-1c94-474a-aa8b-7019b847c0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dfb1dbbb0>]}
[0m20:06:47.116493 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model main.clinicaltrials_mart ................. [[31mERROR[0m in 0.05s]
[0m20:06:47.117057 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m20:06:47.118371 [debug] [MainThread]: Using duckdb connection "master"
[0m20:06:47.118722 [debug] [MainThread]: On master: BEGIN
[0m20:06:47.119037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:47.140057 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:06:47.140444 [debug] [MainThread]: On master: COMMIT
[0m20:06:47.140747 [debug] [MainThread]: Using duckdb connection "master"
[0m20:06:47.141050 [debug] [MainThread]: On master: COMMIT
[0m20:06:47.141428 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:06:47.141731 [debug] [MainThread]: On master: Close
[0m20:06:47.144098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:47.144434 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m20:06:47.144714 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m20:06:47.145056 [info ] [MainThread]: 
[0m20:06:47.145387 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m20:06:47.146091 [debug] [MainThread]: Command end result
[0m20:06:47.163379 [info ] [MainThread]: 
[0m20:06:47.163787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:06:47.164098 [info ] [MainThread]: 
[0m20:06:47.164478 [error] [MainThread]:   Runtime Error in model clinicaltrials_mart (models/marts/clinicaltrials_mart.sql)
  Binder Error: Table "e" does not have a column named "nct_id"
  LINE 29: ...d": "model.clinical_trials.clinicaltrials_mart"} */
  
    
      
      
  
      create  table
        "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
    
      as (
        WITH base_studies AS (
      SELECT 
          s.nct_id,
          s.protocol_section__identification_module__brief_title as brief_title,
          s.protocol_section__identification_module__official_title as official_title,
          s.protocol_section__status_module__overall_status as overall_status,
          s.protocol_section__status_module__start_date_struct__date as start_date,
          s.protocol_section__status_module__completion_date_struct__date as completion_date,
          s.protocol_section__design_module__study_type as study_type,
          s.protocol_section__design_module__enrollment_info__type as enrollment,
          e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
          sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
          loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
          i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
          ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
          bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
          om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
      FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
      LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s.nct_id = e.nct_id
                                                     ^
[0m20:06:47.164819 [info ] [MainThread]: 
[0m20:06:47.165115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:06:47.165708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1311188, "process_user_time": 1.825994, "process_kernel_time": 0.098783, "process_mem_max_rss": "176252", "process_out_blocks": "13496", "command_success": false, "process_in_blocks": "0"}
[0m20:06:47.166189 [debug] [MainThread]: Command `dbt run` failed at 20:06:47.166122 after 1.13 seconds
[0m20:06:47.166540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e0333c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e0193d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dfb14b1c0>]}
[0m20:06:47.166900 [debug] [MainThread]: Flushing usage events
[0m20:10:27.604144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751349340250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513479783d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751347978430>]}


============================== 20:10:27.606042 | bcfba59c-dd80-4632-99d2-548c4a86749f ==============================
[0m20:10:27.606042 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:10:27.606494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:10:27.762785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513493d5960>]}
[0m20:10:27.813917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751347951990>]}
[0m20:10:27.816109 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m20:10:27.822232 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:10:27.894695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:27.895245 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m20:10:28.084829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m20:10:28.093941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751341180040>]}
[0m20:10:28.151683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751342588460>]}
[0m20:10:28.152167 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m20:10:28.152519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751342588fd0>]}
[0m20:10:28.153745 [info ] [MainThread]: 
[0m20:10:28.154240 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:10:28.157822 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m20:10:28.209232 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m20:10:28.209651 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m20:10:28.209967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:28.234212 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:10:28.235216 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m20:10:28.238147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m20:10:28.238626 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m20:10:28.243611 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:10:28.243950 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m20:10:28.244239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:28.264430 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:10:28.265417 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:10:28.265745 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m20:10:28.266156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:28.266459 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:10:28.266744 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m20:10:28.267163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:28.267799 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:10:28.268104 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:10:28.268383 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:10:28.268744 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:10:28.269062 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m20:10:28.271771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m20:10:28.275697 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:10:28.276034 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m20:10:28.276319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:28.294913 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:10:28.295264 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:10:28.295565 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m20:10:28.313825 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:10:28.314840 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m20:10:28.315319 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m20:10:28.315631 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m20:10:28.318531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75134253fbe0>]}
[0m20:10:28.318977 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:28.319282 [debug] [MainThread]: On master: BEGIN
[0m20:10:28.319559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:28.341012 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:10:28.341370 [debug] [MainThread]: On master: COMMIT
[0m20:10:28.341666 [debug] [MainThread]: Using duckdb connection "master"
[0m20:10:28.341952 [debug] [MainThread]: On master: COMMIT
[0m20:10:28.342320 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:10:28.342620 [debug] [MainThread]: On master: Close
[0m20:10:28.344959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:28.345309 [info ] [MainThread]: 
[0m20:10:28.346946 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:10:28.347426 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m20:10:28.347920 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m20:10:28.348259 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m20:10:28.354043 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.354508 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m20:10:28.376577 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.377099 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.377470 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m20:10:28.377811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:28.401731 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m20:10:28.402163 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.402521 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m20:10:28.403506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:10:28.408198 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.408581 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m20:10:28.409102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:28.411288 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.411659 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m20:10:28.412195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:10:28.424069 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:10:28.424451 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.424809 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:10:28.433845 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:10:28.437114 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:10:28.437462 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m20:10:28.446211 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:10:28.447786 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m20:10:28.610181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751341be0fd0>]}
[0m20:10:28.612211 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.26s]
[0m20:10:28.613992 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:10:28.616047 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m20:10:28.617610 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m20:10:28.618716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m20:10:28.619728 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m20:10:28.626107 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m20:10:28.626587 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m20:10:28.640117 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m20:10:28.640589 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:10:28.640940 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m20:10:28.641294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:28.661097 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:10:28.661499 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:10:28.661907 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        loc.city, loc.state, loc.country,  -- From raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e 
        ON s._dlt_id = e._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc 
        ON s._dlt_id = sc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__contacts_locations_module__locations" loc 
        ON s._dlt_id = loc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i 
        ON s._dlt_id = i._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae 
        ON s._dlt_id = ae._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm 
        ON s._dlt_id = bm._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om 
        ON s._dlt_id = om._dlt_parent_id
)
SELECT * FROM base_studies
    );
  
  
[0m20:11:00.885316 [debug] [Thread-1 (]: SQL status: OK in 32.223 seconds
[0m20:11:00.888187 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:11:00.888620 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart" rename to "clinicaltrials_mart__dbt_backup"
[0m20:11:00.889311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:00.891617 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:11:00.892010 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m20:11:00.892656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:00.896915 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:11:00.897292 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:11:00.897631 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:11:01.110563 [debug] [Thread-1 (]: SQL status: OK in 0.212 seconds
[0m20:11:01.116996 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:11:01.118146 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m20:11:01.128914 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:11:01.132609 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m20:11:01.321715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcfba59c-dd80-4632-99d2-548c4a86749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513425d02e0>]}
[0m20:11:01.322477 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 32.70s]
[0m20:11:01.323011 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m20:11:01.324247 [debug] [MainThread]: Using duckdb connection "master"
[0m20:11:01.324579 [debug] [MainThread]: On master: BEGIN
[0m20:11:01.324878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:01.348502 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m20:11:01.348899 [debug] [MainThread]: On master: COMMIT
[0m20:11:01.349194 [debug] [MainThread]: Using duckdb connection "master"
[0m20:11:01.349622 [debug] [MainThread]: On master: COMMIT
[0m20:11:01.350235 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:11:01.350710 [debug] [MainThread]: On master: Close
[0m20:11:01.353445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:01.353785 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m20:11:01.354074 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m20:11:01.354386 [info ] [MainThread]: 
[0m20:11:01.354702 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 33.20 seconds (33.20s).
[0m20:11:01.355323 [debug] [MainThread]: Command end result
[0m20:11:01.373544 [info ] [MainThread]: 
[0m20:11:01.373971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:01.374299 [info ] [MainThread]: 
[0m20:11:01.374632 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:11:01.375248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.814774, "process_user_time": 34.584087, "process_kernel_time": 0.537939, "process_mem_max_rss": "611772", "process_out_blocks": "393944", "process_in_blocks": "0"}
[0m20:11:01.375719 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:01.375649 after 33.82 seconds
[0m20:11:01.376072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751349340250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513425f5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513425f4e80>]}
[0m20:11:01.376420 [debug] [MainThread]: Flushing usage events
[0m20:14:57.425443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546367d4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754634eb4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754634eb43d0>]}


============================== 20:14:57.427257 | 5d863314-c6f0-49bd-8677-c503b9d7cc26 ==============================
[0m20:14:57.427257 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:14:57.427686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'debug': 'False', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:14:57.576431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754636865a50>]}
[0m20:14:57.624551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754634e810f0>]}
[0m20:14:57.626646 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m20:14:57.632505 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:14:57.700787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:57.701304 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m20:14:57.883639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m20:14:57.892589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75462f969150>]}
[0m20:14:57.949342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546303c20e0>]}
[0m20:14:57.949822 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m20:14:57.950175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546303c3820>]}
[0m20:14:57.951365 [info ] [MainThread]: 
[0m20:14:57.951864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:14:57.955447 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m20:14:58.007162 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m20:14:58.007580 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m20:14:58.007888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:58.032418 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:14:58.033423 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m20:14:58.036380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m20:14:58.036871 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m20:14:58.041734 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:14:58.042084 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m20:14:58.042371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:58.064908 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:14:58.065889 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:14:58.066214 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m20:14:58.066620 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:58.066927 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:14:58.067215 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m20:14:58.067641 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:58.068291 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:14:58.068598 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:14:58.068892 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:14:58.069262 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:58.069562 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m20:14:58.072426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m20:14:58.076389 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:14:58.076704 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m20:14:58.077007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:58.097093 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:14:58.097433 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:14:58.097732 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m20:14:58.115385 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:14:58.116304 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m20:14:58.116751 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m20:14:58.117056 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m20:14:58.119996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546366ea500>]}
[0m20:14:58.120400 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:58.120693 [debug] [MainThread]: On master: BEGIN
[0m20:14:58.120992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:58.142291 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:14:58.142633 [debug] [MainThread]: On master: COMMIT
[0m20:14:58.142925 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:58.143199 [debug] [MainThread]: On master: COMMIT
[0m20:14:58.143569 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:58.143884 [debug] [MainThread]: On master: Close
[0m20:14:58.147082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:14:58.147431 [info ] [MainThread]: 
[0m20:14:58.149049 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:14:58.149534 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m20:14:58.150031 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m20:14:58.150367 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m20:14:58.156027 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.156505 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m20:14:58.178387 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.178892 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.179244 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m20:14:58.179571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:14:58.203360 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m20:14:58.203770 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.204127 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m20:14:58.205109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:58.209741 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.210115 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m20:14:58.210618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:58.212754 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.213106 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m20:14:58.213567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:58.225027 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:14:58.225407 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.225751 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:14:58.234534 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:14:58.238015 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:14:58.238555 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m20:14:58.247461 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:14:58.249435 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m20:14:58.403817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546366ea500>]}
[0m20:14:58.404540 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.25s]
[0m20:14:58.405100 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:14:58.405889 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m20:14:58.406308 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m20:14:58.406762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m20:14:58.407117 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m20:14:58.410611 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m20:14:58.411086 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m20:14:58.425124 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m20:14:58.425612 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:14:58.425954 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m20:14:58.426257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:58.446013 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:14:58.446429 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:14:58.446836 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        i.name AS investigator_name,  -- From raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions
        ae.serious_num_affected AS serious_adverse_events,  -- From raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups
        bm.title AS baseline_measure,  -- From raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures
        om.title AS outcome_measure  -- From raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e 
        ON s._dlt_id = e._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc 
        ON s._dlt_id = sc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i 
        ON s._dlt_id = i._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae 
        ON s._dlt_id = ae._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm 
        ON s._dlt_id = bm._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om 
        ON s._dlt_id = om._dlt_parent_id
)
SELECT * FROM base_studies
    );
  
  
[0m20:14:59.408841 [debug] [Thread-1 (]: SQL status: OK in 0.961 seconds
[0m20:14:59.411605 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:14:59.411995 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart" rename to "clinicaltrials_mart__dbt_backup"
[0m20:14:59.412627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:59.414846 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:14:59.415193 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m20:14:59.415793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:14:59.419818 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:14:59.420180 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:14:59.420508 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:14:59.752644 [debug] [Thread-1 (]: SQL status: OK in 0.332 seconds
[0m20:14:59.754833 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:14:59.755167 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m20:14:59.764518 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:14:59.765554 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m20:14:59.919443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d863314-c6f0-49bd-8677-c503b9d7cc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754634ccbd60>]}
[0m20:14:59.920196 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 1.51s]
[0m20:14:59.920719 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m20:14:59.921693 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:59.922078 [debug] [MainThread]: On master: BEGIN
[0m20:14:59.922388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:59.943439 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:14:59.943823 [debug] [MainThread]: On master: COMMIT
[0m20:14:59.944125 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:59.944399 [debug] [MainThread]: On master: COMMIT
[0m20:14:59.944791 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:59.945118 [debug] [MainThread]: On master: Close
[0m20:14:59.947564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:59.947909 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m20:14:59.948195 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m20:14:59.948520 [info ] [MainThread]: 
[0m20:14:59.948868 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m20:14:59.949490 [debug] [MainThread]: Command end result
[0m20:14:59.967289 [info ] [MainThread]: 
[0m20:14:59.967699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:59.968018 [info ] [MainThread]: 
[0m20:14:59.968321 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:14:59.968908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5843916, "process_user_time": 3.154896, "process_kernel_time": 0.182863, "process_mem_max_rss": "300528", "process_out_blocks": "66760", "process_in_blocks": "0"}
[0m20:14:59.969379 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:59.969312 after 2.58 seconds
[0m20:14:59.969715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546367d4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546366dc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546303c36d0>]}
[0m20:14:59.970062 [debug] [MainThread]: Flushing usage events
[0m20:16:55.027796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a4630370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a2c7bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a2c7bf40>]}


============================== 20:16:55.029615 | 5535f5c0-ea42-4147-afde-d234ac8fc732 ==============================
[0m20:16:55.029615 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:16:55.030070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'dbt', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:55.178891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d349ed28d30>]}
[0m20:16:55.227603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a2c3edd0>]}
[0m20:16:55.229700 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m20:16:55.235649 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:16:55.304363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:55.304900 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m20:16:55.486999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m20:16:55.495968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d349bb74070>]}
[0m20:16:55.552832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d349cf7c520>]}
[0m20:16:55.553313 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m20:16:55.553657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d349cf7ff10>]}
[0m20:16:55.554889 [info ] [MainThread]: 
[0m20:16:55.555395 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:16:55.559095 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m20:16:55.611666 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m20:16:55.612121 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m20:16:55.612421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:55.636085 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:16:55.637069 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m20:16:55.639853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m20:16:55.640295 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m20:16:55.645181 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:16:55.645583 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m20:16:55.645911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:55.667302 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:16:55.668269 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:16:55.668590 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m20:16:55.669002 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:55.669294 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:16:55.669561 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m20:16:55.669969 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:55.670566 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:16:55.670863 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:16:55.671135 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:16:55.671486 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:55.671786 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m20:16:55.674628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m20:16:55.678664 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:16:55.679004 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m20:16:55.679281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:55.698938 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:16:55.699278 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:16:55.699576 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m20:16:55.717158 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:16:55.718109 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m20:16:55.718564 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m20:16:55.718874 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m20:16:55.721594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a45388e0>]}
[0m20:16:55.722008 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:55.722304 [debug] [MainThread]: On master: BEGIN
[0m20:16:55.722572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:55.743354 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:16:55.743719 [debug] [MainThread]: On master: COMMIT
[0m20:16:55.744021 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:55.744302 [debug] [MainThread]: On master: COMMIT
[0m20:16:55.744676 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:55.744976 [debug] [MainThread]: On master: Close
[0m20:16:55.747281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:55.747634 [info ] [MainThread]: 
[0m20:16:55.749338 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:16:55.749872 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m20:16:55.750334 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m20:16:55.750666 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m20:16:55.756254 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.756719 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m20:16:55.777800 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.778294 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.778636 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m20:16:55.778964 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:16:55.800962 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m20:16:55.801365 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.801706 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m20:16:55.802650 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:16:55.807145 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.807510 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m20:16:55.808000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:55.810102 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.810453 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m20:16:55.810916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:55.822164 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:16:55.822537 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.822876 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:16:55.831521 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:16:55.834873 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:16:55.835222 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m20:16:55.843910 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:16:55.845491 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m20:16:56.003464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a45388e0>]}
[0m20:16:56.004682 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.25s]
[0m20:16:56.005704 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:16:56.007264 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m20:16:56.007846 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m20:16:56.008387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m20:16:56.008843 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m20:16:56.012554 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.013013 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m20:16:56.026825 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.027451 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.027804 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m20:16:56.028114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:56.048010 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:16:56.048395 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.048783 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        STRING_AGG(i.name, ', ') AS investigator_name,  -- Aggregate investigator names
        STRING_AGG(ae.serious_num_affected::TEXT, ', ') AS serious_adverse_events,  -- Aggregate serious adverse events
        STRING_AGG(bm.title, ', ') AS baseline_measure,  -- Aggregate baseline measures
        STRING_AGG(om.title, ', ') AS outcome_measure  -- Aggregate outcome measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e 
        ON s._dlt_id = e._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc 
        ON s._dlt_id = sc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i 
        ON s._dlt_id = i._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae 
        ON s._dlt_id = ae._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm 
        ON s._dlt_id = bm._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om 
        ON s._dlt_id = om._dlt_parent_id
    GROUP BY s.nct_id, brief_title, official_title, overall_status, start_date, completion_date, study_type, enrollment, condition, sponsor_name
)
SELECT * FROM base_studies
    );
  
  
[0m20:16:56.365722 [debug] [Thread-1 (]: SQL status: OK in 0.316 seconds
[0m20:16:56.368501 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.368912 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart" rename to "clinicaltrials_mart__dbt_backup"
[0m20:16:56.369578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:56.371814 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.372183 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m20:16:56.372787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:16:56.376892 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:16:56.377274 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.377616 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:16:56.494087 [debug] [Thread-1 (]: SQL status: OK in 0.116 seconds
[0m20:16:56.496318 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:16:56.496677 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m20:16:56.784081 [debug] [Thread-1 (]: SQL status: OK in 0.287 seconds
[0m20:16:56.785370 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m20:16:56.795506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5535f5c0-ea42-4147-afde-d234ac8fc732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a2dd2f20>]}
[0m20:16:56.796143 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 0.79s]
[0m20:16:56.796689 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m20:16:56.797633 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:56.797987 [debug] [MainThread]: On master: BEGIN
[0m20:16:56.798287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:56.819145 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m20:16:56.819517 [debug] [MainThread]: On master: COMMIT
[0m20:16:56.819833 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:56.820120 [debug] [MainThread]: On master: COMMIT
[0m20:16:56.820516 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:56.820821 [debug] [MainThread]: On master: Close
[0m20:16:56.823200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:56.823526 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m20:16:56.823834 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m20:16:56.824169 [info ] [MainThread]: 
[0m20:16:56.824502 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m20:16:56.825119 [debug] [MainThread]: Command end result
[0m20:16:56.843674 [info ] [MainThread]: 
[0m20:16:56.844103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:56.844430 [info ] [MainThread]: 
[0m20:16:56.844757 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:16:56.845387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8588349, "process_user_time": 2.620834, "process_kernel_time": 0.294994, "process_mem_max_rss": "448368", "process_out_blocks": "268424", "process_in_blocks": "0"}
[0m20:16:56.845872 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:56.845804 after 1.86 seconds
[0m20:16:56.846227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a4630370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a41c5f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d34a41c4430>]}
[0m20:16:56.846581 [debug] [MainThread]: Flushing usage events
[0m20:18:08.905705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886bf40370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886a587fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886a587f40>]}


============================== 20:18:08.907525 | 6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4 ==============================
[0m20:18:08.907525 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:08.907981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'debug': 'False', 'profiles_dir': 'dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:18:09.056289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886a434d30>]}
[0m20:18:09.104616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886a54edd0>]}
[0m20:18:09.106729 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m20:18:09.112551 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:18:09.180962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:09.181498 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m20:18:09.363534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m20:18:09.372585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758863d7c070>]}
[0m20:18:09.430016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758865188520>]}
[0m20:18:09.430492 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m20:18:09.430862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886518bf10>]}
[0m20:18:09.432061 [info ] [MainThread]: 
[0m20:18:09.432547 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:18:09.436025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m20:18:09.487124 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m20:18:09.487543 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m20:18:09.487851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:09.511177 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:18:09.512183 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m20:18:09.514997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m20:18:09.515468 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m20:18:09.520297 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:18:09.520628 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m20:18:09.520940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:09.540905 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:18:09.541879 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:18:09.542205 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m20:18:09.542603 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:09.542910 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:18:09.543199 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m20:18:09.543615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:09.544253 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:18:09.544553 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:18:09.544844 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:18:09.545219 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:09.545541 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m20:18:09.548361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m20:18:09.552400 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:18:09.552720 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m20:18:09.553027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:09.571405 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:18:09.571734 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:18:09.572037 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m20:18:09.591196 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:18:09.592130 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m20:18:09.592581 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m20:18:09.592888 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m20:18:09.595754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886be448e0>]}
[0m20:18:09.596195 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:09.596491 [debug] [MainThread]: On master: BEGIN
[0m20:18:09.596780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:09.617108 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m20:18:09.617460 [debug] [MainThread]: On master: COMMIT
[0m20:18:09.617750 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:09.618037 [debug] [MainThread]: On master: COMMIT
[0m20:18:09.618402 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:09.618706 [debug] [MainThread]: On master: Close
[0m20:18:09.621047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:18:09.621402 [info ] [MainThread]: 
[0m20:18:09.623057 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:18:09.623555 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m20:18:09.624046 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m20:18:09.624381 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m20:18:09.630172 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.630654 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m20:18:09.652698 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.653204 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.653553 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m20:18:09.653893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:18:09.677752 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m20:18:09.678165 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.678508 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m20:18:09.679504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:18:09.684076 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.684445 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m20:18:09.684944 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:18:09.687078 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.687433 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m20:18:09.687918 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:18:09.699392 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:18:09.699771 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.700126 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:18:09.709428 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:18:09.713399 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:18:09.713762 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m20:18:09.723130 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:18:09.725150 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m20:18:09.879572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886be448e0>]}
[0m20:18:09.880665 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.25s]
[0m20:18:09.881626 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:18:09.882945 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m20:18:09.884119 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m20:18:09.884620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m20:18:09.885036 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m20:18:09.888770 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m20:18:09.889257 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m20:18:09.903006 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m20:18:09.903487 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:18:09.903828 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m20:18:09.904147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:09.924069 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:18:09.924522 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:18:09.925011 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        e.value AS condition,  -- From raw_clinicaltrials_studies__protocol_section__conditions_module__conditions
        sc.name AS sponsor_name,  -- From raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators
        STRING_AGG(DISTINCT i.name, ', ') AS investigator_name,  -- Aggregate distinct investigator names
        STRING_AGG(DISTINCT ae.serious_num_affected::TEXT, ', ') AS serious_adverse_events,  -- Aggregate distinct serious adverse events
        STRING_AGG(DISTINCT bm.title, ', ') AS baseline_measure,  -- Aggregate distinct baseline measures
        STRING_AGG(DISTINCT om.title, ', ') AS outcome_measure  -- Aggregate distinct outcome measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e 
        ON s._dlt_id = e._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc 
        ON s._dlt_id = sc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i 
        ON s._dlt_id = i._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae 
        ON s._dlt_id = ae._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm 
        ON s._dlt_id = bm._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om 
        ON s._dlt_id = om._dlt_parent_id
    GROUP BY s.nct_id, brief_title, official_title, overall_status, start_date, completion_date, study_type, enrollment, condition, sponsor_name
)
SELECT * FROM base_studies
    );
  
  
[0m20:18:10.436784 [debug] [Thread-1 (]: SQL status: OK in 0.511 seconds
[0m20:18:10.439533 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:18:10.439942 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart" rename to "clinicaltrials_mart__dbt_backup"
[0m20:18:10.440581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:18:10.442763 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:18:10.443131 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m20:18:10.443761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:18:10.447950 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:18:10.448321 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:18:10.448652 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:18:10.477203 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m20:18:10.480160 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:18:10.480624 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m20:18:10.490017 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:18:10.491981 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m20:18:10.698274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3f7dd0-fd10-493a-be0d-ecd081b9c6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886be448e0>]}
[0m20:18:10.699411 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 0.81s]
[0m20:18:10.700342 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m20:18:10.701904 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:10.702303 [debug] [MainThread]: On master: BEGIN
[0m20:18:10.702634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:10.729957 [debug] [MainThread]: SQL status: OK in 0.027 seconds
[0m20:18:10.730316 [debug] [MainThread]: On master: COMMIT
[0m20:18:10.730614 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:10.730917 [debug] [MainThread]: On master: COMMIT
[0m20:18:10.731323 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:10.731639 [debug] [MainThread]: On master: Close
[0m20:18:10.733989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:10.734367 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m20:18:10.734665 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m20:18:10.734995 [info ] [MainThread]: 
[0m20:18:10.735319 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m20:18:10.735944 [debug] [MainThread]: Command end result
[0m20:18:10.754847 [info ] [MainThread]: 
[0m20:18:10.755275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:18:10.755595 [info ] [MainThread]: 
[0m20:18:10.755919 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:18:10.756524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8920128, "process_user_time": 3.114792, "process_kernel_time": 0.188229, "process_mem_max_rss": "324756", "process_out_blocks": "41328", "process_in_blocks": "0"}
[0m20:18:10.757012 [debug] [MainThread]: Command `dbt run` succeeded at 20:18:10.756944 after 1.89 seconds
[0m20:18:10.757347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886bf40370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886b200af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75886a434d30>]}
[0m20:18:10.757686 [debug] [MainThread]: Flushing usage events
[0m20:19:39.571816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4c638370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4ac74370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4ac743d0>]}


============================== 20:19:39.573610 | fe6b05c6-b816-4c6f-b2b9-e2741c661115 ==============================
[0m20:19:39.573610 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:19:39.574066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:19:39.722061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb46d30d30>]}
[0m20:19:39.769977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4ac4add0>]}
[0m20:19:39.772067 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m20:19:39.777843 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:19:39.845692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:39.846217 [debug] [MainThread]: Partial parsing: updated file: clinical_trials://models/marts/clinicaltrials_mart.sql
[0m20:19:40.028116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m20:19:40.037075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb43b84070>]}
[0m20:19:40.093569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb44f84520>]}
[0m20:19:40.094059 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m20:19:40.094409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb44f87f10>]}
[0m20:19:40.095651 [info ] [MainThread]: 
[0m20:19:40.096179 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:19:40.099721 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m20:19:40.151003 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m20:19:40.151417 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m20:19:40.151722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:40.175026 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:19:40.176022 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m20:19:40.178846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m20:19:40.179291 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m20:19:40.184107 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:19:40.184428 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m20:19:40.184708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:40.204664 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:19:40.205616 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:19:40.205943 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m20:19:40.206338 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:19:40.206630 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:19:40.206915 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m20:19:40.207330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:19:40.207955 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:19:40.208265 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m20:19:40.208541 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m20:19:40.208909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:19:40.209202 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m20:19:40.211929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m20:19:40.215845 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:19:40.216176 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m20:19:40.216459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:40.234655 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:19:40.235010 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m20:19:40.235300 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m20:19:40.252960 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:19:40.253895 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m20:19:40.254364 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m20:19:40.254660 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m20:19:40.257609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4c53c8e0>]}
[0m20:19:40.258044 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:40.258339 [debug] [MainThread]: On master: BEGIN
[0m20:19:40.258609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:40.279032 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m20:19:40.279392 [debug] [MainThread]: On master: COMMIT
[0m20:19:40.279688 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:40.279973 [debug] [MainThread]: On master: COMMIT
[0m20:19:40.280354 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:19:40.280668 [debug] [MainThread]: On master: Close
[0m20:19:40.283078 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:40.283430 [info ] [MainThread]: 
[0m20:19:40.285092 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:19:40.285569 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m20:19:40.286041 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m20:19:40.286389 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m20:19:40.292061 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.292528 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m20:19:40.314099 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.314602 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.314962 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m20:19:40.315288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:19:40.339379 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m20:19:40.339791 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.340145 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m20:19:40.341113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:19:40.345668 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.346040 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m20:19:40.346528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:40.348666 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.349023 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m20:19:40.349508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:40.360908 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:19:40.361282 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.361631 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m20:19:40.370318 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:19:40.374029 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m20:19:40.374381 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m20:19:40.383201 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:19:40.385206 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m20:19:40.562478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4c53c8e0>]}
[0m20:19:40.564400 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.27s]
[0m20:19:40.565754 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m20:19:40.567680 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m20:19:40.568691 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m20:19:40.569460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m20:19:40.570125 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m20:19:40.575065 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m20:19:40.575683 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m20:19:40.589244 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m20:19:40.589715 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:19:40.590053 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m20:19:40.590355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:40.610315 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m20:19:40.610736 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:19:40.611129 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        STRING_AGG(DISTINCT e.value, ', ') AS condition,  -- Combine distinct conditions
        STRING_AGG(DISTINCT sc.name, ', ') AS sponsor_name,  -- Combine distinct sponsors
        STRING_AGG(DISTINCT i.name, ', ') AS investigator_name,  -- Combine distinct investigator names
        STRING_AGG(DISTINCT ae.serious_num_affected::TEXT, ', ') AS serious_adverse_events,  -- Combine distinct serious adverse events
        STRING_AGG(DISTINCT bm.title, ', ') AS baseline_measure,  -- Combine distinct baseline measures
        STRING_AGG(DISTINCT om.title, ', ') AS outcome_measure  -- Combine distinct outcome measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e 
        ON s._dlt_id = e._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc 
        ON s._dlt_id = sc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i 
        ON s._dlt_id = i._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae 
        ON s._dlt_id = ae._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm 
        ON s._dlt_id = bm._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om 
        ON s._dlt_id = om._dlt_parent_id
    GROUP BY s.nct_id, brief_title, official_title, overall_status, start_date, completion_date, study_type, enrollment
)
SELECT * FROM base_studies
    );
  
  
[0m20:19:41.127841 [debug] [Thread-1 (]: SQL status: OK in 0.516 seconds
[0m20:19:41.130546 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:19:41.130956 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart" rename to "clinicaltrials_mart__dbt_backup"
[0m20:19:41.131586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:41.133737 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:19:41.134088 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m20:19:41.134656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:19:41.138517 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:19:41.138868 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:19:41.139176 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m20:19:41.162572 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m20:19:41.166436 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m20:19:41.167109 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m20:19:41.176015 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:19:41.178191 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m20:19:41.361186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6b05c6-b816-4c6f-b2b9-e2741c661115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4c53c8e0>]}
[0m20:19:41.362170 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 0.79s]
[0m20:19:41.362717 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m20:19:41.363719 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:41.364071 [debug] [MainThread]: On master: BEGIN
[0m20:19:41.364372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:41.384578 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m20:19:41.384950 [debug] [MainThread]: On master: COMMIT
[0m20:19:41.385243 [debug] [MainThread]: Using duckdb connection "master"
[0m20:19:41.385522 [debug] [MainThread]: On master: COMMIT
[0m20:19:41.385937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:19:41.386254 [debug] [MainThread]: On master: Close
[0m20:19:41.388585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:41.388931 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m20:19:41.389211 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m20:19:41.389522 [info ] [MainThread]: 
[0m20:19:41.389878 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m20:19:41.390500 [debug] [MainThread]: Command end result
[0m20:19:41.408561 [info ] [MainThread]: 
[0m20:19:41.408975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:41.409279 [info ] [MainThread]: 
[0m20:19:41.409582 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:19:41.410192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8792688, "process_user_time": 2.495891, "process_kernel_time": 0.20699, "process_mem_max_rss": "283592", "process_out_blocks": "32608", "process_in_blocks": "0"}
[0m20:19:41.410667 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:41.410601 after 1.88 seconds
[0m20:19:41.411014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4c638370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb44581900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73eb4ac4add0>]}
[0m20:19:41.411347 [debug] [MainThread]: Flushing usage events
[0m21:02:49.103199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75841a7d4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758418ec7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758418ec7f10>]}


============================== 21:02:49.105118 | c70ea03b-34ce-414a-a18f-dee952740823 ==============================
[0m21:02:49.105118 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:02:49.105568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:02:49.257406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75841a865a50>]}
[0m21:02:49.307095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758418e8d210>]}
[0m21:02:49.309250 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m21:02:49.315394 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:02:49.385302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:49.385700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:49.390510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m21:02:49.411995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75841435f130>]}
[0m21:02:49.471413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7584143c45e0>]}
[0m21:02:49.471873 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m21:02:49.472211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7584143c7670>]}
[0m21:02:49.473429 [info ] [MainThread]: 
[0m21:02:49.473917 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:02:49.477519 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m21:02:49.498434 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m21:02:49.498810 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m21:02:49.499117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:49.522809 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:02:49.523834 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m21:02:49.526883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m21:02:49.527376 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m21:02:49.532294 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:02:49.532637 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m21:02:49.532949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:49.552644 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m21:02:49.553649 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:02:49.553977 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m21:02:49.554375 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:02:49.554669 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:02:49.554951 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m21:02:49.555353 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:02:49.555975 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m21:02:49.556287 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:02:49.556567 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m21:02:49.556957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:02:49.557257 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m21:02:49.560735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m21:02:49.564727 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m21:02:49.565069 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m21:02:49.565350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:49.583542 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m21:02:49.583903 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m21:02:49.584203 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m21:02:49.602054 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m21:02:49.603017 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m21:02:49.603467 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m21:02:49.603765 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m21:02:49.606868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75841a5b9930>]}
[0m21:02:49.607304 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:49.607621 [debug] [MainThread]: On master: BEGIN
[0m21:02:49.607920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:49.628795 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m21:02:49.629180 [debug] [MainThread]: On master: COMMIT
[0m21:02:49.629482 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:49.629763 [debug] [MainThread]: On master: COMMIT
[0m21:02:49.630147 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:02:49.630451 [debug] [MainThread]: On master: Close
[0m21:02:49.633085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:49.633454 [info ] [MainThread]: 
[0m21:02:49.634907 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m21:02:49.635412 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m21:02:49.635913 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m21:02:49.636249 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m21:02:49.642578 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.643103 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m21:02:49.664342 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.664839 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.665183 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m21:02:49.665498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:02:49.687723 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m21:02:49.688138 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.688490 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m21:02:49.689477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:02:49.694002 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.694368 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies" rename to "raw_clinicaltrials_studies__dbt_backup"
[0m21:02:49.694887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:02:49.696979 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.697325 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m21:02:49.697819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:02:49.708914 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m21:02:49.709286 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.709627 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m21:02:49.718589 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:02:49.721979 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:02:49.722323 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m21:02:49.730992 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:02:49.732633 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m21:02:49.889398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758411189870>]}
[0m21:02:49.890858 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.25s]
[0m21:02:49.892060 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m21:02:49.893328 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m21:02:49.894010 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m21:02:49.894644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m21:02:49.895216 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m21:02:49.899990 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m21:02:49.900461 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m21:02:49.944123 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m21:02:49.944729 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:02:49.945107 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m21:02:49.945428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:49.965156 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m21:02:49.965542 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:02:49.965937 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        STRING_AGG(DISTINCT e.value, ', ') AS condition,  -- Combine distinct conditions
        STRING_AGG(DISTINCT sc.name, ', ') AS sponsor_name,  -- Combine distinct sponsors
        STRING_AGG(DISTINCT i.name, ', ') AS investigator_name,  -- Combine distinct investigator names
        STRING_AGG(DISTINCT ae.serious_num_affected::TEXT, ', ') AS serious_adverse_events,  -- Combine distinct serious adverse events
        STRING_AGG(DISTINCT bm.title, ', ') AS baseline_measure,  -- Combine distinct baseline measures
        STRING_AGG(DISTINCT om.title, ', ') AS outcome_measure  -- Combine distinct outcome measures
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e 
        ON s._dlt_id = e._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc 
        ON s._dlt_id = sc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i 
        ON s._dlt_id = i._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae 
        ON s._dlt_id = ae._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm 
        ON s._dlt_id = bm._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om 
        ON s._dlt_id = om._dlt_parent_id
    GROUP BY s.nct_id, brief_title, official_title, overall_status, start_date, completion_date, study_type, enrollment
)
SELECT * FROM base_studies
    );
  
  
[0m21:02:50.518400 [debug] [Thread-1 (]: SQL status: OK in 0.552 seconds
[0m21:02:50.521137 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:02:50.521533 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart" rename to "clinicaltrials_mart__dbt_backup"
[0m21:02:50.522187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:02:50.524441 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:02:50.524816 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m21:02:50.525421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:02:50.529581 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m21:02:50.529962 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:02:50.530305 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m21:02:50.552855 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m21:02:50.555684 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:02:50.556073 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m21:02:50.565498 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:02:50.567632 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m21:02:50.754651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70ea03b-34ce-414a-a18f-dee952740823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7584107cad10>]}
[0m21:02:50.756065 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 0.86s]
[0m21:02:50.756943 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m21:02:50.758367 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:50.758893 [debug] [MainThread]: On master: BEGIN
[0m21:02:50.759369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:50.780678 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m21:02:50.781051 [debug] [MainThread]: On master: COMMIT
[0m21:02:50.781352 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:50.781637 [debug] [MainThread]: On master: COMMIT
[0m21:02:50.782072 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:02:50.782393 [debug] [MainThread]: On master: Close
[0m21:02:50.784728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:50.785065 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m21:02:50.785346 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m21:02:50.785667 [info ] [MainThread]: 
[0m21:02:50.786043 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m21:02:50.786678 [debug] [MainThread]: Command end result
[0m21:02:50.805340 [info ] [MainThread]: 
[0m21:02:50.805758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:50.806085 [info ] [MainThread]: 
[0m21:02:50.806401 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:02:50.807012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7464019, "process_user_time": 2.966964, "process_kernel_time": 0.165165, "process_mem_max_rss": "275696", "process_out_blocks": "31248", "process_in_blocks": "0"}
[0m21:02:50.807498 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:50.807429 after 1.75 seconds
[0m21:02:50.807850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75841a7d4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758410778a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758410778e50>]}
[0m21:02:50.808198 [debug] [MainThread]: Flushing usage events
[0m21:32:18.027570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbcfc20340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbce260370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbce2603d0>]}


============================== 21:32:18.029542 | d7fb0b84-cb7f-4454-8fb7-6f47f4932f8a ==============================
[0m21:32:18.029542 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:32:18.030001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir dbt --profiles-dir dbt', 'send_anonymous_usage_stats': 'True'}
[0m21:32:18.195141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbcfcbda50>]}
[0m21:32:18.244745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbce22d0f0>]}
[0m21:32:18.246939 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m21:32:18.253510 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:32:18.315880 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m21:32:18.316345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbcf0e80d0>]}
[0m21:32:19.148171 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- sources.raw_data
[0m21:32:19.156472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbc67400a0>]}
[0m21:32:19.215621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbc6716260>]}
[0m21:32:19.216113 [info ] [MainThread]: Found 2 models, 10 sources, 416 macros
[0m21:32:19.216481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbc6715e40>]}
[0m21:32:19.217694 [info ] [MainThread]: 
[0m21:32:19.218211 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:32:19.221886 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_clinical_trials'
[0m21:32:19.242607 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials"
[0m21:32:19.242986 [debug] [ThreadPool]: On list_clinical_trials: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"clinical_trials"'
    
  
  
[0m21:32:19.243301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:19.268080 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m21:32:19.269104 [debug] [ThreadPool]: On list_clinical_trials: Close
[0m21:32:19.271758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clinical_trials, now create_clinical_trials_main)
[0m21:32:19.272250 [debug] [ThreadPool]: Creating schema "database: "clinical_trials"
schema: "main"
"
[0m21:32:19.277150 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:32:19.277497 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
        select type from duckdb_databases()
        where database_name='clinical_trials'
        and type='sqlite'
    
  
[0m21:32:19.277804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:19.298033 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m21:32:19.299025 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:32:19.299349 [debug] [ThreadPool]: On create_clinical_trials_main: BEGIN
[0m21:32:19.299750 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:19.300064 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:32:19.300351 [debug] [ThreadPool]: On create_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_clinical_trials_main"} */

    
    
        create schema if not exists "clinical_trials"."main"
    
[0m21:32:19.300764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:19.301406 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m21:32:19.301709 [debug] [ThreadPool]: Using duckdb connection "create_clinical_trials_main"
[0m21:32:19.302006 [debug] [ThreadPool]: On create_clinical_trials_main: COMMIT
[0m21:32:19.302390 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:32:19.302696 [debug] [ThreadPool]: On create_clinical_trials_main: Close
[0m21:32:19.305473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_clinical_trials_main, now list_clinical_trials_main)
[0m21:32:19.309464 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m21:32:19.309797 [debug] [ThreadPool]: On list_clinical_trials_main: BEGIN
[0m21:32:19.310088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:19.328619 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m21:32:19.328950 [debug] [ThreadPool]: Using duckdb connection "list_clinical_trials_main"
[0m21:32:19.329243 [debug] [ThreadPool]: On list_clinical_trials_main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_clinical_trials_main"} */
select
      'clinical_trials' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'clinical_trials'
  
[0m21:32:19.346737 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m21:32:19.347592 [debug] [ThreadPool]: On list_clinical_trials_main: ROLLBACK
[0m21:32:19.348042 [debug] [ThreadPool]: Failed to rollback 'list_clinical_trials_main'
[0m21:32:19.348337 [debug] [ThreadPool]: On list_clinical_trials_main: Close
[0m21:32:19.351097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbc677d300>]}
[0m21:32:19.351547 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:19.351887 [debug] [MainThread]: On master: BEGIN
[0m21:32:19.352188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:19.373241 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m21:32:19.373584 [debug] [MainThread]: On master: COMMIT
[0m21:32:19.373881 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:19.374159 [debug] [MainThread]: On master: COMMIT
[0m21:32:19.374532 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:32:19.374843 [debug] [MainThread]: On master: Close
[0m21:32:19.377227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:32:19.377608 [info ] [MainThread]: 
[0m21:32:19.379208 [debug] [Thread-1 (]: Began running node model.clinical_trials.raw_clinicaltrials_studies
[0m21:32:19.379702 [info ] [Thread-1 (]: 1 of 2 START sql view model main.raw_clinicaltrials_studies .................... [RUN]
[0m21:32:19.380159 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.clinical_trials.raw_clinicaltrials_studies'
[0m21:32:19.380491 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.raw_clinicaltrials_studies
[0m21:32:19.386225 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:32:19.386700 [debug] [Thread-1 (]: Began executing node model.clinical_trials.raw_clinicaltrials_studies
[0m21:32:19.407509 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:32:19.408009 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:32:19.408352 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: BEGIN
[0m21:32:19.408663 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:32:19.427228 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m21:32:19.427603 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:32:19.427953 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */

  
  create view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" as (
    -- models/raw_data/raw_clinicaltrials_studies.sql
-- Query the raw clinical trials data using the source reference
SELECT * FROM "clinical_trials"."raw_data"."raw_clinicaltrials_studies"
  );

[0m21:32:19.428880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:32:19.433341 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:32:19.433707 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
alter view "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_tmp" rename to "raw_clinicaltrials_studies"
[0m21:32:19.434195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:19.443924 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m21:32:19.444293 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:32:19.444619 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: COMMIT
[0m21:32:19.454660 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:32:19.458592 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.raw_clinicaltrials_studies"
[0m21:32:19.459001 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.raw_clinicaltrials_studies"} */
drop view if exists "clinical_trials"."main"."raw_clinicaltrials_studies__dbt_backup" cascade
[0m21:32:19.459571 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:19.461212 [debug] [Thread-1 (]: On model.clinical_trials.raw_clinicaltrials_studies: Close
[0m21:32:19.615119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbcfcbe110>]}
[0m21:32:19.616393 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.raw_clinicaltrials_studies ............... [[32mOK[0m in 0.23s]
[0m21:32:19.617443 [debug] [Thread-1 (]: Finished running node model.clinical_trials.raw_clinicaltrials_studies
[0m21:32:19.618902 [debug] [Thread-1 (]: Began running node model.clinical_trials.clinicaltrials_mart
[0m21:32:19.619537 [info ] [Thread-1 (]: 2 of 2 START sql table model main.clinicaltrials_mart .......................... [RUN]
[0m21:32:19.620123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinical_trials.raw_clinicaltrials_studies, now model.clinical_trials.clinicaltrials_mart)
[0m21:32:19.620604 [debug] [Thread-1 (]: Began compiling node model.clinical_trials.clinicaltrials_mart
[0m21:32:19.624705 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinical_trials.clinicaltrials_mart"
[0m21:32:19.625175 [debug] [Thread-1 (]: Began executing node model.clinical_trials.clinicaltrials_mart
[0m21:32:19.638096 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinical_trials.clinicaltrials_mart"
[0m21:32:19.638607 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:32:19.638960 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: BEGIN
[0m21:32:19.639267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:19.657579 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m21:32:19.657997 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:32:19.658386 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */

  
    
    

    create  table
      "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp"
  
    as (
      WITH base_studies AS (
    SELECT 
        s.nct_id,
        s.protocol_section__identification_module__brief_title as brief_title,
        s.protocol_section__identification_module__official_title as official_title,
        s.protocol_section__status_module__overall_status as overall_status,
        s.protocol_section__status_module__start_date_struct__date as start_date,
        s.protocol_section__status_module__completion_date_struct__date as completion_date,
        s.protocol_section__design_module__study_type as study_type,
        s.protocol_section__design_module__enrollment_info__type as enrollment,
        STRING_AGG(DISTINCT e.value, ', ') AS condition,
        STRING_AGG(DISTINCT sc.name, ', ') AS sponsor_name,
        STRING_AGG(DISTINCT i.name, ', ') AS investigator_name,
        STRING_AGG(DISTINCT ae.serious_num_affected::TEXT, ', ') AS serious_adverse_events,
        STRING_AGG(DISTINCT bm.title, ', ') AS baseline_measure,
        STRING_AGG(DISTINCT om.title, ', ') AS outcome_measure
    FROM "clinical_trials"."main"."raw_clinicaltrials_studies" s
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__conditions_module__conditions" e ON s._dlt_id = e._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__sponsor_collaborators_module__collaborators" sc ON s._dlt_id = sc._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__protocol_section__arms_interventions_module__interventions" i ON s._dlt_id = i._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__adverse_events_module__event_groups" ae ON s._dlt_id = ae._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__baseline_characteristics_module__measures" bm ON s._dlt_id = bm._dlt_parent_id
    LEFT JOIN "clinical_trials"."raw_data"."raw_clinicaltrials_studies__results_section__outcome_measures_module__outcome_measures" om ON s._dlt_id = om._dlt_parent_id
    GROUP BY s.nct_id, brief_title, official_title, overall_status, start_date, completion_date, study_type, enrollment
)
SELECT * FROM base_studies
    );
  
  
[0m21:32:20.201475 [debug] [Thread-1 (]: SQL status: OK in 0.543 seconds
[0m21:32:20.205062 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:32:20.205454 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
alter table "clinical_trials"."main"."clinicaltrials_mart__dbt_tmp" rename to "clinicaltrials_mart"
[0m21:32:20.206130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:20.209860 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m21:32:20.210222 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:32:20.210544 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: COMMIT
[0m21:32:20.232900 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m21:32:20.235390 [debug] [Thread-1 (]: Using duckdb connection "model.clinical_trials.clinicaltrials_mart"
[0m21:32:20.235823 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.clinical_trials.clinicaltrials_mart"} */
drop table if exists "clinical_trials"."main"."clinicaltrials_mart__dbt_backup" cascade
[0m21:32:20.236553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:32:20.237799 [debug] [Thread-1 (]: On model.clinical_trials.clinicaltrials_mart: Close
[0m21:32:20.431646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7fb0b84-cb7f-4454-8fb7-6f47f4932f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbc35de9b0>]}
[0m21:32:20.432937 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main.clinicaltrials_mart ..................... [[32mOK[0m in 0.81s]
[0m21:32:20.433661 [debug] [Thread-1 (]: Finished running node model.clinical_trials.clinicaltrials_mart
[0m21:32:20.434984 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:20.435473 [debug] [MainThread]: On master: BEGIN
[0m21:32:20.435907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:20.457586 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m21:32:20.457975 [debug] [MainThread]: On master: COMMIT
[0m21:32:20.458275 [debug] [MainThread]: Using duckdb connection "master"
[0m21:32:20.458558 [debug] [MainThread]: On master: COMMIT
[0m21:32:20.458967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:32:20.459269 [debug] [MainThread]: On master: Close
[0m21:32:20.461697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:20.462051 [debug] [MainThread]: Connection 'list_clinical_trials_main' was properly closed.
[0m21:32:20.462330 [debug] [MainThread]: Connection 'model.clinical_trials.clinicaltrials_mart' was properly closed.
[0m21:32:20.462643 [info ] [MainThread]: 
[0m21:32:20.462982 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m21:32:20.463606 [debug] [MainThread]: Command end result
[0m21:32:20.481950 [info ] [MainThread]: 
[0m21:32:20.482392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:20.482725 [info ] [MainThread]: 
[0m21:32:20.483068 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:32:20.483893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5000095, "process_user_time": 3.197323, "process_kernel_time": 0.189308, "process_mem_max_rss": "286108", "process_in_blocks": "672", "process_out_blocks": "33096"}
[0m21:32:20.484382 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:20.484313 after 2.50 seconds
[0m21:32:20.484726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbcfc20340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbc85965c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adbc3589a50>]}
[0m21:32:20.485084 [debug] [MainThread]: Flushing usage events
